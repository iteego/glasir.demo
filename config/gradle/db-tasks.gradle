import com.iteego.glasir.build.api.tasks.*

task createManagementChangesets(type: CreateChangesets, description: "Creates database and data change sets for management node") {
  description = "Creates glasir.db change sets and import definition and extracts required file assets."

  mainModuleName = "node.admin.dev"

  selectedInstanceTypes = ["management"]

  importFileName = "versioned-imports.txt"

//Unique addon IDs: [abandoned_orders, switchingdatasource, storefront_demo, international, 
//                   fulfillment, storefront_no_publishing, storefront-full-setup, merch]
//FORCE ADDON dcsui_siteadmin_versioned "Add commerce data to SiteAdmin" from group siteadmin "SiteAdmin Addons :"
//FORCE ADDON fulfillment_using_atg "Fulfillment using ATG Platform" from group store_fufillment "Choose ATG Commerce Reference Store Fulfillment AddOns :"

  selectedAddons = [
"abandoned_orders", "switchingdatasource", "storefront_demo", "international", 
"fulfillment", "storefront_no_publishing", "storefront-full-setup", "merch",
"dcsui_siteadmin_versioned", "fulfillment_using_atg"

/*    "international",
    "merch",
    "previewOnManagement",
    "prodLock",
    "queryConsoleOnManagement",
    "switchingdatasource",
    "dcsui_siteadmin_versioned",
    "storefront_demo",
    "storefront-full-setup" */
  ]

  substitutions = ["merchandisingPassword":"merchandising", "adminPublishingPassword":"admin"]  

  useXml = false
}

task createProductionChangesets(type: CreateChangesets, description: "Creates database and data change sets for production node") {
  description = "Like createManagementChangesets but with instance type \"production\" and another main module."

  mainModuleName = "node.store.dev"

  selectedInstanceTypes = ["production"]

  importFileName = "non-versioned-imports.txt"

  selectedAddons = [
"abandoned_orders", "switchingdatasource", "storefront_demo", "international", 
"fulfillment", "storefront_no_publishing", "storefront-full-setup", "merch",
"dcsui_siteadmin_versioned", "fulfillment_using_atg" ]

/*  selectedAddons = [
    "international",
    "merch",
    "prodLock",
    "storefront_demo",
    "storefront-full-setup",
    "switchingdatasource"
  ]
*/

  useXml = false
}

task listAddons(type:ListAvailableAddons, description: "Lists available/installed ATG addons") {}

task listProducts(type:ListAvailableProducts, description: "Lists available/installed ATG products") {
  description = "List Installed ATG Products"
}

task listProductionDatasources(type: ListDatasources, description: "Lists data sources for production node type") {
  mainModuleName = "node.store.dev"

  selectedAddons = [
    "international",
    "merch",
    "prodLock",
    "storefront_demo",
    "storefront-full-setup",
    "switchingdatasource"
  ]
}

task listManagementDatasources(type: ListDatasources, description: "Lists data sources for management node type") {
  mainModuleName = "node.admin.dev"

  selectedAddons = [
    "international",
    "merch",
    "previewOnManagement",
    "prodLock",
    "queryConsoleOnManagement",
    "switchingdatasource",
    "dcsui_siteadmin_versioned"
  ]
}
